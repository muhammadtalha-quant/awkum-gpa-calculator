<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWKUM GPA/CGPA Calculator</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.31/jspdf.plugin.autotable.min.js"></script>

    <style>
        :root {
            /* Material 3 Inspired Color Tokens */
            --md-sys-color-primary: #005AC1; /* AWKUM Blue-ish */
            --md-sys-color-on-primary: #FFFFFF;
            --md-sys-color-primary-container: #D8E2FF;
            --md-sys-color-on-primary-container: #001A41;
            
            --md-sys-color-secondary: #575E71;
            --md-sys-color-surface: #FEF7FF;
            --md-sys-color-surface-container: #F3F3FA;
            --md-sys-color-on-surface: #1B1B1F;
            
            --md-sys-color-error: #BA1A1A;
            --md-sys-color-outline: #74777F;
            
            --border-radius-lg: 16px;
            --border-radius-sm: 8px;
            
            --elevation-1: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
            --elevation-2: 0px 4px 8px 3px rgba(0, 0, 0, 0.15);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Roboto', sans-serif;
        }

        body {
            background-color: var(--md-sys-color-surface-container);
            color: var(--md-sys-color-on-surface);
            line-height: 1.5;
            padding-bottom: 60px;
        }

        /* --- Layout & Typography --- */
        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 24px 16px;
        }

        h1, h2, h3 {
            font-weight: 500;
        }

        /* --- Header --- */
        header {
            text-align: center;
            margin-bottom: 32px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 16px;
        }

        .logo {
            width: 100px;
            height: auto;
            /* Ensure it renders nicely */
            object-fit: contain;
        }

        .university-name {
            font-size: 1.5rem;
            color: var(--md-sys-color-on-surface);
            font-weight: 700;
        }

        .app-title {
            font-size: 1rem;
            color: var(--md-sys-color-secondary);
            background-color: var(--md-sys-color-primary-container);
            color: var(--md-sys-color-on-primary-container);
            padding: 4px 12px;
            border-radius: 50px;
            display: inline-block;
        }

        /* --- Navigation Tabs --- */
        .tabs {
            display: flex;
            justify-content: center;
            gap: 8px;
            margin-bottom: 24px;
            background: white;
            padding: 8px;
            border-radius: 50px;
            width: fit-content;
            margin-left: auto;
            margin-right: auto;
            box-shadow: var(--elevation-1);
        }

        .tab-btn {
            border: none;
            background: transparent;
            padding: 10px 24px;
            border-radius: 40px;
            cursor: pointer;
            font-weight: 500;
            color: var(--md-sys-color-secondary);
            transition: all 0.2s ease;
        }

        .tab-btn.active {
            background-color: var(--md-sys-color-primary);
            color: var(--md-sys-color-on-primary);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease-in-out;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* --- Cards --- */
        .card {
            background: white;
            border-radius: var(--border-radius-lg);
            padding: 24px;
            box-shadow: var(--elevation-1);
            margin-bottom: 24px;
            border: 1px solid #eee;
        }

        .card-header {
            margin-bottom: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        /* --- Calculation Tables --- */
        .calc-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 16px;
        }

        .calc-table th {
            text-align: left;
            font-size: 0.85rem;
            color: var(--md-sys-color-secondary);
            padding: 8px;
            border-bottom: 2px solid var(--md-sys-color-primary-container);
        }

        .calc-table td {
            padding: 8px;
            vertical-align: middle;
        }

        /* --- Input Fields --- */
        input[type="text"], input[type="number"] {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--md-sys-color-outline);
            border-radius: var(--border-radius-sm);
            font-size: 1rem;
            transition: border-color 0.2s;
        }

        input:focus {
            outline: none;
            border-color: var(--md-sys-color-primary);
            border-width: 2px;
            padding: 9px; /* adjust for border width */
        }

        input:disabled {
            background-color: #f5f5f5;
            color: var(--md-sys-color-secondary);
            border-color: #e0e0e0;
        }

        input.error {
            border-color: var(--md-sys-color-error);
            background-color: #FFF9F9;
        }

        /* --- Buttons --- */
        .action-bar {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-top: 16px;
        }

        .btn {
            padding: 10px 24px;
            border-radius: 100px;
            border: none;
            font-weight: 500;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: transform 0.1s;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn-primary {
            background-color: var(--md-sys-color-primary);
            color: white;
            box-shadow: var(--elevation-1);
        }

        .btn-outlined {
            background-color: transparent;
            border: 1px solid var(--md-sys-color-outline);
            color: var(--md-sys-color-primary);
        }

        .btn-text {
            background: transparent;
            color: var(--md-sys-color-error);
            padding: 10px 16px;
        }

        .icon-btn {
            background: transparent;
            border: none;
            color: var(--md-sys-color-secondary);
            cursor: pointer;
            padding: 8px;
            border-radius: 50%;
        }
        
        .icon-btn:hover {
            background-color: #f0f0f0;
            color: var(--md-sys-color-error);
        }

        /* --- Results Section --- */
        .result-box {
            background-color: var(--md-sys-color-primary-container);
            color: var(--md-sys-color-on-primary-container);
            padding: 24px;
            border-radius: var(--border-radius-lg);
            text-align: center;
            display: none; /* Hidden by default */
            margin-top: 24px;
        }

        .result-box.visible {
            display: block;
            animation: fadeIn 0.5s;
        }

        .gpa-display {
            font-size: 3.5rem;
            font-weight: 700;
            line-height: 1;
        }

        .grade-display {
            font-size: 1.5rem;
            opacity: 0.8;
            margin-top: 8px;
        }

        /* --- Grading Chart --- */
        .grading-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 12px;
            margin-top: 16px;
        }

        .grade-item {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 12px;
            text-align: center;
        }

        .grade-item strong {
            display: block;
            font-size: 1.2rem;
            color: var(--md-sys-color-primary);
        }

        .grade-item span {
            font-size: 0.8rem;
            color: var(--md-sys-color-secondary);
        }

        /* --- Formulas --- */
        .formula-block {
            font-family: 'Courier New', monospace;
            background: #f0f0f0;
            padding: 12px;
            border-radius: 8px;
            font-size: 0.9rem;
            margin: 8px 0;
            border-left: 4px solid var(--md-sys-color-primary);
        }

        @media (max-width: 600px) {
            .container { padding: 12px; }
            .calc-table th:nth-child(4), .calc-table td:nth-child(4) { display: none; } /* Hide Weighted GP on mobile */
            .btn { width: 100%; justify-content: center; }
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <img src="AWKUM.jpg" 
     alt="AWKUM Logo" 
     class="logo" 
     id="awkum-logo">
            <div>
                <div class="university-name">Abdul Wali Khan University Mardan</div>
                <div style="margin-top:8px;"><span class="app-title">Official GPA Calculator</span></div>
            </div>
        </header>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('sgpa')">SGPA</button>
            <button class="tab-btn" onclick="switchTab('cgpa')">CGPA</button>
        </div>

        <div id="sgpa" class="tab-content active">
            <div class="card">
                <div class="card-header">
                    <h2>Semester GPA</h2>
                    <button class="btn-text" onclick="clearSGPA()">Clear All</button>
                </div>
                
                <p style="margin-bottom: 16px; color: var(--md-sys-color-secondary); font-size: 0.9rem;">
                    Enter your marks (0-100) and credit hours. Grade Points are calculated automatically.
                </p>

                <div style="overflow-x: auto;">
                    <table class="calc-table" id="sgpa-table">
                        <thead>
                            <tr>
                                <th width="35%">Subject Name</th>
                                <th width="15%">Credits</th>
                                <th width="15%">Marks</th>
                                <th width="15%">Grade Point</th>
                                <th width="10%">Grade</th>
                                <th width="10%"></th>
                            </tr>
                        </thead>
                        <tbody id="sgpa-body">
                            </tbody>
                    </table>
                </div>

                <div class="action-bar">
                    <button class="btn btn-outlined" onclick="addSGPARow()">+ Add Subject</button>
                    <button class="btn btn-primary" onclick="calculateSGPA()">Calculate SGPA</button>
                    <button class="btn btn-outlined" onclick="exportPDF('SGPA')" id="btn-export-sgpa" disabled>Export DMC (PDF)</button>
                </div>

                <div id="sgpa-result" class="result-box">
                    <div style="text-transform: uppercase; font-size: 0.8rem; letter-spacing: 1px;">Semester GPA</div>
                    <div class="gpa-display" id="sgpa-value">0.00</div>
                    <div class="grade-display" id="sgpa-letter">Grade: F</div>
                </div>
            </div>
        </div>

        <div id="cgpa" class="tab-content">
            <div class="card">
                <div class="card-header">
                    <h2>Cumulative GPA</h2>
                    <button class="btn-text" onclick="clearCGPA()">Clear All</button>
                </div>

                <p style="margin-bottom: 16px; color: var(--md-sys-color-secondary); font-size: 0.9rem;">
                    Enter the GPA obtained in each semester and total credits for that semester.
                </p>

                <div style="overflow-x: auto;">
                    <table class="calc-table" id="cgpa-table">
                        <thead>
                            <tr>
                                <th width="40%">Semester</th>
                                <th width="20%">Obtained GPA</th>
                                <th width="20%">Total Credits</th>
                                <th width="10%"></th>
                            </tr>
                        </thead>
                        <tbody id="cgpa-body">
                            </tbody>
                    </table>
                </div>

                <div class="action-bar">
                    <button class="btn btn-outlined" onclick="addCGPARow()">+ Add Semester</button>
                    <button class="btn btn-primary" onclick="calculateCGPA()">Calculate CGPA</button>
                    <button class="btn btn-outlined" onclick="exportPDF('CGPA')" id="btn-export-cgpa" disabled>Export DMC (PDF)</button>
                </div>

                <div id="cgpa-result" class="result-box">
                    <div style="text-transform: uppercase; font-size: 0.8rem; letter-spacing: 1px;">Cumulative GPA</div>
                    <div class="gpa-display" id="cgpa-value">0.00</div>
                    <div class="grade-display" id="cgpa-letter">Grade: F</div>
                    <div style="margin-top: 10px; font-size: 0.9rem;" id="cgpa-status"></div>
                </div>
            </div>
        </div>

        <div class="card">
            <h3>How the GPA is Calculated</h3>
            
            <div style="margin-top: 16px;">
                <strong>1. Marks to Grade Point Conversion</strong>
                <p class="formula-block">
                    If Marks >= 90: GP = 4.00<br>
                    If 50 <= Marks < 90: GP = 2.00 + (Marks - 50) * 0.05<br>
                    If Marks < 50: GP = 0.00 (Fail)
                </p>
                <p style="font-size: 0.85rem; color: #666;">
                    * AWKUM uses a linear scale where every mark above 50 adds 0.05 to the Grade Point.
                </p>
            </div>

            <div style="margin-top: 16px;">
                <strong>2. Formulas</strong>
                <p class="formula-block">
                    SGPA = Σ (Subject GP × Credit Hours) / Total Credit Hours
                </p>
                <p class="formula-block">
                    CGPA = Σ (Semester GPA × Semester Credits) / Total Credits So Far
                </p>
            </div>
        </div>

        <div class="card">
            <h3>AWKUM Grading Chart</h3>
            <div class="grading-grid" id="grading-chart">
                </div>
        </div>
    </div>

    <script>
        /* --- 1. Logic & Data --- */
        
        // Generates the visual chart based on ranges
        const gradeRanges = [
            { label: 'A+', min: 90, max: 100, gp: '4.00' },
            { label: 'A', min: 87, max: 89, gp: '3.85-3.95' },
            { label: 'A-', min: 82, max: 86, gp: '3.60-3.80' },
            { label: 'B+', min: 77, max: 81, gp: '3.35-3.55' },
            { label: 'B', min: 72, max: 76, gp: '3.10-3.30' },
            { label: 'B-', min: 67, max: 71, gp: '2.85-3.05' },
            { label: 'C+', min: 62, max: 66, gp: '2.60-2.80' },
            { label: 'C', min: 57, max: 61, gp: '2.35-2.55' },
            { label: 'C-', min: 52, max: 56, gp: '2.10-2.30' },
            { label: 'D', min: 50, max: 51, gp: '2.00-2.05' },
            { label: 'F', min: 0, max: 49, gp: '0.00' }
        ];

        // The core calculation logic for a single subject
        function calculateGradePoint(marks) {
            marks = Math.round(parseFloat(marks)); // Round to nearest integer as per standard practice
            if (marks >= 90) return 4.00;
            if (marks < 50) return 0.00;
            
            // Linear Formula based on AWKUM table
            return 2.00 + ((marks - 50) * 0.05);
        }

        function getLetterFromGP(gp) {
            gp = parseFloat(gp);
            if (gp >= 4.00) return 'A+';
            if (gp >= 3.85) return 'A';
            if (gp >= 3.60) return 'A-';
            if (gp >= 3.35) return 'B+';
            if (gp >= 3.10) return 'B';
            if (gp >= 2.85) return 'B-';
            if (gp >= 2.60) return 'C+';
            if (gp >= 2.35) return 'C';
            if (gp >= 2.10) return 'C-';
            if (gp >= 2.00) return 'D';
            return 'F';
        }

        /* --- 2. UI Rendering --- */

        function renderGradingChart() {
            const container = document.getElementById('grading-chart');
            gradeRanges.forEach(g => {
                const div = document.createElement('div');
                div.className = 'grade-item';
                div.innerHTML = `<strong>${g.label}</strong><span>${g.min} - ${g.max}</span><br><span style="color:#005AC1; font-weight:500">${g.gp}</span>`;
                container.appendChild(div);
            });
        }

        function switchTab(tabId) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }

        /* --- 3. SGPA Logic --- */

        let sgpaRowCount = 0;

        function addSGPARow() {
            sgpaRowCount++;
            const tbody = document.getElementById('sgpa-body');
            const tr = document.createElement('tr');
            tr.id = `sgpa-row-${sgpaRowCount}`;
            tr.innerHTML = `
                <td><input type="text" placeholder="Subject ${sgpaRowCount}" class="sgpa-name"></td>
                <td><input type="number" placeholder="3" min="1" max="6" class="sgpa-credit" oninput="updateRowCalc(${sgpaRowCount})"></td>
                <td><input type="number" placeholder="0-100" min="0" max="100" class="sgpa-mark" oninput="updateRowCalc(${sgpaRowCount})"></td>
                <td class="sgpa-gp-display">-</td>
                <td class="sgpa-grade-display">-</td>
                <td><button class="icon-btn" onclick="removeRow('sgpa-row-${sgpaRowCount}')">✕</button></td>
            `;
            tbody.appendChild(tr);
        }

        function updateRowCalc(id) {
            const row = document.getElementById(`sgpa-row-${id}`);
            const markInput = row.querySelector('.sgpa-mark');
            const gpDisplay = row.querySelector('.sgpa-gp-display');
            const gradeDisplay = row.querySelector('.sgpa-grade-display');

            const marks = parseFloat(markInput.value);

            // Reset validation style
            markInput.classList.remove('error');

            if (!isNaN(marks) && marks >= 0 && marks <= 100) {
                const gp = calculateGradePoint(marks);
                const letter = getLetterFromGP(gp);
                gpDisplay.textContent = gp.toFixed(2);
                gradeDisplay.textContent = letter;
            } else {
                if(markInput.value !== "") markInput.classList.add('error');
                gpDisplay.textContent = "-";
                gradeDisplay.textContent = "-";
            }
        }

        function calculateSGPA() {
            const rows = document.querySelectorAll('#sgpa-body tr');
            let totalWeightedGP = 0;
            let totalCredits = 0;
            let isValid = true;
            let hasData = false;

            rows.forEach(row => {
                const creditInput = row.querySelector('.sgpa-credit');
                const markInput = row.querySelector('.sgpa-mark');

                const credit = parseFloat(creditInput.value);
                const mark = parseFloat(markInput.value);

                // Validation
                if (isNaN(credit) || credit <= 0) {
                    creditInput.classList.add('error');
                    isValid = false;
                }
                if (isNaN(mark) || mark < 0 || mark > 100) {
                    markInput.classList.add('error');
                    isValid = false;
                }

                if (isValid) {
                    hasData = true;
                    const gp = calculateGradePoint(mark);
                    totalWeightedGP += (gp * credit);
                    totalCredits += credit;
                }
            });

            if (!hasData || !isValid || totalCredits === 0) {
                alert("Please check your inputs. Ensure credits are positive and marks are 0-100.");
                return;
            }

            const sgpa = totalWeightedGP / totalCredits;
            document.getElementById('sgpa-value').textContent = sgpa.toFixed(2);
            document.getElementById('sgpa-letter').textContent = `Grade: ${getLetterFromGP(sgpa)}`;
            document.getElementById('sgpa-result').classList.add('visible');
            document.getElementById('btn-export-sgpa').disabled = false;
        }

        function clearSGPA() {
            document.getElementById('sgpa-body').innerHTML = '';
            document.getElementById('sgpa-result').classList.remove('visible');
            document.getElementById('btn-export-sgpa').disabled = true;
            sgpaRowCount = 0;
            addSGPARow();
        }

        /* --- 4. CGPA Logic --- */
        let cgpaRowCount = 0;

        function addCGPARow() {
            cgpaRowCount++;
            const tbody = document.getElementById('cgpa-body');
            const tr = document.createElement('tr');
            tr.id = `cgpa-row-${cgpaRowCount}`;
            tr.innerHTML = `
                <td><input type="text" placeholder="Semester ${cgpaRowCount}" value="Semester ${cgpaRowCount}" class="cgpa-name"></td>
                <td><input type="number" placeholder="0.00-4.00" min="0" max="4" step="0.01" class="cgpa-val"></td>
                <td><input type="number" placeholder="Total Credits" min="1" class="cgpa-credit"></td>
                <td><button class="icon-btn" onclick="removeRow('cgpa-row-${cgpaRowCount}')">✕</button></td>
            `;
            tbody.appendChild(tr);
        }

        function calculateCGPA() {
            const rows = document.querySelectorAll('#cgpa-body tr');
            let totalWeightedGPA = 0;
            let totalCredits = 0;
            let isValid = true;
            let hasData = false;

            rows.forEach(row => {
                const gpaInput = row.querySelector('.cgpa-val');
                const creditInput = row.querySelector('.cgpa-credit');

                const gpa = parseFloat(gpaInput.value);
                const credit = parseFloat(creditInput.value);

                if (isNaN(gpa) || gpa < 0 || gpa > 4.00) {
                    gpaInput.classList.add('error');
                    isValid = false;
                }
                if (isNaN(credit) || credit <= 0) {
                    creditInput.classList.add('error');
                    isValid = false;
                }

                if (isValid) {
                    hasData = true;
                    totalWeightedGPA += (gpa * credit);
                    totalCredits += credit;
                }
            });

            if (!hasData || !isValid || totalCredits === 0) {
                alert("Please valid inputs. GPA must be 0-4.00, Credits must be positive.");
                return;
            }

            const cgpa = totalWeightedGPA / totalCredits;
            document.getElementById('cgpa-value').textContent = cgpa.toFixed(2);
            document.getElementById('cgpa-letter').textContent = `Grade: ${getLetterFromGP(cgpa)}`;
            document.getElementById('cgpa-result').classList.add('visible');
            
            const statusEl = document.getElementById('cgpa-status');
            if (cgpa < 2.0) {
                statusEl.textContent = "Status: Warning - Below Degree Requirement (2.00)";
                statusEl.style.color = "var(--md-sys-color-error)";
            } else {
                statusEl.textContent = "Status: Satisfactory";
                statusEl.style.color = "green";
            }
            document.getElementById('btn-export-cgpa').disabled = false;
        }

        function clearCGPA() {
            document.getElementById('cgpa-body').innerHTML = '';
            document.getElementById('cgpa-result').classList.remove('visible');
            document.getElementById('btn-export-cgpa').disabled = true;
            cgpaRowCount = 0;
            addCGPARow();
        }

        function removeRow(id) {
            document.getElementById(id).remove();
        }

        /* --- 5. Export PDF (DMC) --- */
        async function exportPDF(type) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            // --- LOGO INSERTION LOGIC ---
            // We use the image element from the HTML directly.
            // Wrapped in try/catch to ensure PDF generates even if CORS blocks the image.
            const logoImg = document.getElementById('awkum-logo');
            try {
                // Position: x=14, y=10, w=25, h=25 (Square Aspect)
                doc.addImage(logoImg, 'JPEG', 14, 10, 25, 25);
            } catch (error) {
                console.warn("Could not embed logo due to browser security (CORS). Exporting without logo.", error);
            }

            // -- Header --
            doc.setFontSize(16);
            doc.setFont("helvetica", "bold");
            // Center text on page (105 is half of A4 width 210)
            doc.text("Abdul Wali Khan University Mardan", 105, 20, null, null, "center");
            
            doc.setFontSize(12);
            doc.setFont("helvetica", "normal");
            doc.text(`Official ${type} Report (DMC)`, 105, 28, null, null, "center");
            
            // Line separator
            doc.setLineWidth(0.5);
            doc.line(14, 38, 196, 38);

            // -- Table Data Preparation --
            let head = [];
            let body = [];
            let summary = [];

            if (type === 'SGPA') {
                head = [['Subject', 'Credits', 'Marks', 'Grade Point', 'Grade']];
                const rows = document.querySelectorAll('#sgpa-body tr');
                rows.forEach(row => {
                    const name = row.querySelector('.sgpa-name').value || "Untitled Subject";
                    const cr = row.querySelector('.sgpa-credit').value;
                    const mk = row.querySelector('.sgpa-mark').value;
                    const gp = row.querySelector('.sgpa-gp-display').textContent;
                    const gr = row.querySelector('.sgpa-grade-display').textContent;
                    body.push([name, cr, mk, gp, gr]);
                });
                summary = [
                    [`Semester GPA: ${document.getElementById('sgpa-value').textContent}`],
                    [`Letter Grade: ${document.getElementById('sgpa-letter').textContent.replace('Grade: ', '')}`]
                ];
            } else {
                head = [['Semester', 'Obtained GPA', 'Credits', 'Weighted Contribution']];
                const rows = document.querySelectorAll('#cgpa-body tr');
                rows.forEach(row => {
                    const name = row.querySelector('.cgpa-name').value;
                    const val = row.querySelector('.cgpa-val').value;
                    const cr = row.querySelector('.cgpa-credit').value;
                    const w = (parseFloat(val) * parseFloat(cr)).toFixed(2);
                    body.push([name, val, cr, w]);
                });
                 summary = [
                    [`Cumulative GPA: ${document.getElementById('cgpa-value').textContent}`],
                    [`Letter Grade: ${document.getElementById('cgpa-letter').textContent.replace('Grade: ', '')}`]
                ];
            }

            // -- Render Table --
            doc.autoTable({
                startY: 45,
                head: head,
                body: body,
                theme: 'grid',
                headStyles: { fillColor: [0, 90, 193] }, // AWKUM Blue
                styles: { fontSize: 10, cellPadding: 4 }
            });

            // -- Summary Box --
            const finalY = doc.lastAutoTable.finalY + 10;
            doc.setFont("helvetica", "bold");
            doc.text("Summary:", 14, finalY);
            doc.setFont("helvetica", "normal");
            summary.forEach((line, index) => {
                doc.text(line[0], 14, finalY + 8 + (index*6));
            });

            // -- Footer --
            doc.setFontSize(8);
            doc.setTextColor(100);
            doc.text("Generated via AWKUM Static Web Calculator. This document is computer-generated.", 105, 280, null, null, "center");

            // -- Save --
            doc.save(`AWKUM_${type}_Report.pdf`);
        }

        // Initialize
        window.onload = function() {
            renderGradingChart();
            addSGPARow();
            addCGPARow();
        };

    </script>
</body>
</html>
